<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>aging_cmsac22.knit</title>
    <meta charset="utf-8" />
    <script src="aging_cmsac22_files/header-attrs/header-attrs.js"></script>
    <link href="aging_cmsac22_files/remark-css/default.css" rel="stylesheet" />
    <script src="aging_cmsac22_files/kePrint/kePrint.js"></script>
    <link href="aging_cmsac22_files/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="aging_themer.css" type="text/css" />
    <link rel="stylesheet" href="aging_custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# <div class="line-block">Estimating Aging Curves: <br> Using Multiple Imputation to Examine Career Trajectories of MLB Offensive Players</div>
]
.subtitle[
## Quang Nguyen
]
.institute[
### #CMSAC22
]
.date[
### <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.4 151.7c.325 4.548 .325 9.097 .325 13.65 0 138.7-105.6 298.6-298.6 298.6-59.45 0-114.7-17.22-161.1-47.11 8.447 .974 16.57 1.299 25.34 1.299 49.06 0 94.21-16.57 130.3-44.83-46.13-.975-84.79-31.19-98.11-72.77 6.498 .974 12.99 1.624 19.82 1.624 9.421 0 18.84-1.3 27.61-3.573-48.08-9.747-84.14-51.98-84.14-102.1v-1.299c13.97 7.797 30.21 12.67 47.43 13.32-28.26-18.84-46.78-51.01-46.78-87.39 0-19.49 5.197-37.36 14.29-52.95 51.65 63.67 129.3 105.3 216.4 109.8-1.624-7.797-2.599-15.92-2.599-24.04 0-57.83 46.78-104.9 104.9-104.9 30.21 0 57.5 12.67 76.67 33.14 23.72-4.548 46.46-13.32 66.6-25.34-7.798 24.37-24.37 44.83-46.13 57.83 21.12-2.273 41.58-8.122 60.43-16.24-14.29 20.79-32.16 39.31-52.63 54.25z"/></svg> <span class="citation">@qntkhvn</span>       <svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> qntkhvn       <svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"/></svg> qntkhvn.netlify.app <br> <br> bit.ly/aging_cmsac22
]

---


layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;#CMSAC22&lt;/span&gt;&lt;/div&gt;

---






## Aging curves in sports literature

*   Common themes: quadratic form, peak age, discrete observations

*   Challenge: survival bias

    *   Observe only "good enough" players
    
    *   Ignore players that "might be involved"

&lt;img src="bellbrown.png" width="35%" style="display: block; margin: auto;" /&gt;


---

&lt;!-- Missing data post several dilemma in analyzing data: --&gt;
&lt;!-- – If you use the original data and exclude people with missing data --&gt;
&lt;!-- from the analysis, you do not use all the information contained in the --&gt;
&lt;!-- data. --&gt;

## Player performance and missing data

*   **Player survivorship/dropout = missing data problem**

*   Recent works have shown that missing data provide valuable information in estimating performance.

    *   Schuckers et al. (2021)
&gt; ... The use of imputation also has potential to impact this methodology and, thus, being aware of what we don’t observe can make our estimation stronger.
    *   Stival et al. (2022)
&gt; ... missing data patterns are informative in predicting
performances and they constitute a structural part of the signal explaining the observed variability of the runners’ performances.

---

## Goals

What would the aging curve look like if players competed in every season from a fixed range of age?

(i.e. What would have happened if a player who was forced to retire from their league at a certain age had played a full career?)

&lt;img src="roy.gif" width="50%" style="display: block; margin: auto;" /&gt;

---

## Data

*   Baseball ⚾

*   `Lahman` database, `Batting` and `People` tables.

*   Assumptions
 
    *   Fixed career length (age 21 to 39)
    
    *   Observe player-seasons with 100 or more plate appearances
    
---

## Multiple imputation

*   Account for the different variability sources due to missing data

*   Procedure:

    *   Fill in the missing values for `\(m\)` copies of the original data
    
    *   Analyze each of the `\(m\)` completed datasets
    
    *   Pool the results to get estimates and standard errors

*   **Multivariate imputation by chained equations using a two-level normal linear mixed model with heterogeneous within-group variance**

    *   Hierarchical structure: seasons (ages) for each player
    
    *   Performance across seasons are correlated

---

## Simulation setup

*   Generating player careers

`$$Y_{pq} = (\beta_0 + b_{0p}) + \beta_1X_q + \beta_2X_q^2 + \beta_3X_q^3 + \epsilon_{pq}$$`
`$$b_{0p} \sim N(0, \tau^2)$$`
`$$\epsilon_{pq} \sim N(0, \sigma^2)$$`

*   Generating missing data
    
    *   Dropout players with low 4-year performance average (MAR)
    
    *   Dropout players with low performance at the start of career (MAR)
    
    *   Randomly removing players (25% at age 30) (MCAR)
    
---

## Dropout effects

.pull-left[

*   Randomly removing players has very little effect

*   Dropout based on performance results in an overestimation

]

.pull-right[

&lt;img src="aging_cmsac22_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---

## Imputation results

.pull-left[

Aging curve for dropout based on low performance at the start of career 

&lt;img src="aging_cmsac22_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[

Confidence intervals for combined estimates

&lt;table class="table" style="font-size: 12.5px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;background-color: #ededed !important;"&gt; Age &lt;/th&gt;
   &lt;th style="text-align:center;background-color: #ededed !important;"&gt; OPS &lt;/th&gt;
   &lt;th style="text-align:center;background-color: #ededed !important;"&gt; 95% CI &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6694 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.4057, 0.9391) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6667 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.4021, 0.9378) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6675 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.4050, 0.9362) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 29 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6684 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.4031, 0.9400) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 30 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6587 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.3989, 0.9260) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 31 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6585 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.3985, 0.9259) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6533 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.3959, 0.9187) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 33 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6418 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.3876, 0.9056) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;width: 5em; background-color: white !important;"&gt; 34 &lt;/td&gt;
   &lt;td style="text-align:center;width: 7em; background-color: white !important;"&gt; 0.6421 &lt;/td&gt;
   &lt;td style="text-align:center;width: 10em; background-color: white !important;"&gt; (0.3828, 0.9114) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


]

---

## Application: MLB Data

.pull-left[

* Aging curve for players with debut year 1985 or after

* Performance declines with age faster than estimates based on only the observed data

]

.pull-right[

&lt;img src="aging_cmsac22_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---

## Next steps

*   Think more about the missingness mechanism for real data

*   Consider a better performance measure (e.g. linear weights)

*   Improve simulation (e.g. add random terms for age)

*   Functional data approach

---

## Acknowledgements: Greg

&lt;br&gt;

&lt;img src="gjm.gif" width="50%" style="display: block; margin: auto;" /&gt;

&lt;body&gt;
&lt;center&gt;
  Dr. Fashion 
  &lt;br&gt;
  <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
  &lt;a href=https://www.instagram.com/greg.equals.fashion/&gt;greg.equals.fashion&lt;/a&gt;
&lt;/center&gt;
&lt;/body&gt;

---

## Cheers!

*   Paper: **[arxiv.org/abs/2210.02383](https://arxiv.org/abs/2210.02383)**

*   Code: **[github.com/qntkhvn/cmsac_rrc](https://github.com/qntkhvn/cmsac_rrc)**

*   Slides: **[bit.ly/aging_cmsac22](https://bit.ly/aging_cmsac22)**
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
