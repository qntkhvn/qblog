<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>DATA 229 - FINAL PROJECT</title>
  <meta name="description" content="DATA 229 - FINAL PROJECT">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="DATA 229 - FINAL PROJECT" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="DATA 229 - FINAL PROJECT" />
  
  
  

<meta name="author" content="Quang Nguyen">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="part-i-dolphins.html">
<link rel="next" href="part-ii-grades.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About The Project</a></li>
<li class="chapter" data-level="2" data-path="part-i-kenken.html"><a href="part-i-kenken.html"><i class="fa fa-check"></i><b>2</b> Part I - KenKen</a><ul>
<li class="chapter" data-level="2.1" data-path="part-i-kenken.html"><a href="part-i-kenken.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="part-i-kenken.html"><a href="part-i-kenken.html#topic"><i class="fa fa-check"></i><b>2.1.1</b> Topic</a></li>
<li class="chapter" data-level="2.1.2" data-path="part-i-kenken.html"><a href="part-i-kenken.html#data"><i class="fa fa-check"></i><b>2.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="part-i-kenken.html"><a href="part-i-kenken.html#analysis"><i class="fa fa-check"></i><b>2.2</b> Analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="part-i-kenken.html"><a href="part-i-kenken.html#solution-time"><i class="fa fa-check"></i><b>2.2.1</b> Solution Time</a></li>
<li class="chapter" data-level="2.2.2" data-path="part-i-kenken.html"><a href="part-i-kenken.html#factors-that-affect-the-solution-time"><i class="fa fa-check"></i><b>2.2.2</b> Factors that affect the solution time</a></li>
<li class="chapter" data-level="2.2.3" data-path="part-i-kenken.html"><a href="part-i-kenken.html#did-the-solvers-get-faster"><i class="fa fa-check"></i><b>2.2.3</b> Did the solvers get faster?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="part-i-solar.html"><a href="part-i-solar.html"><i class="fa fa-check"></i><b>3</b> Part I - Solar</a><ul>
<li class="chapter" data-level="3.1" data-path="part-i-solar.html"><a href="part-i-solar.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="part-i-solar.html"><a href="part-i-solar.html#topic-1"><i class="fa fa-check"></i><b>3.1.1</b> Topic</a></li>
<li class="chapter" data-level="3.1.2" data-path="part-i-solar.html"><a href="part-i-solar.html#data-1"><i class="fa fa-check"></i><b>3.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="part-i-solar.html"><a href="part-i-solar.html#data-wrangling"><i class="fa fa-check"></i><b>3.2</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.2.1" data-path="part-i-solar.html"><a href="part-i-solar.html#early-reports"><i class="fa fa-check"></i><b>3.2.1</b> Early Reports</a></li>
<li class="chapter" data-level="3.2.2" data-path="part-i-solar.html"><a href="part-i-solar.html#remaining-reports"><i class="fa fa-check"></i><b>3.2.2</b> Remaining Reports</a></li>
<li class="chapter" data-level="3.2.3" data-path="part-i-solar.html"><a href="part-i-solar.html#joining-tables"><i class="fa fa-check"></i><b>3.2.3</b> Joining Tables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="part-i-solar.html"><a href="part-i-solar.html#data-exploring"><i class="fa fa-check"></i><b>3.3</b> Data Exploring</a><ul>
<li class="chapter" data-level="3.3.1" data-path="part-i-solar.html"><a href="part-i-solar.html#energy"><i class="fa fa-check"></i><b>3.3.1</b> 2017 Energy</a></li>
<li class="chapter" data-level="3.3.2" data-path="part-i-solar.html"><a href="part-i-solar.html#monthly-energy"><i class="fa fa-check"></i><b>3.3.2</b> Monthly Energy</a></li>
<li class="chapter" data-level="3.3.3" data-path="part-i-solar.html"><a href="part-i-solar.html#no-energy-generated"><i class="fa fa-check"></i><b>3.3.3</b> No Energy Generated</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html"><i class="fa fa-check"></i><b>4</b> Part I - Dolphins</a><ul>
<li class="chapter" data-level="4.1" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="4.1.1" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#topic-2"><i class="fa fa-check"></i><b>4.1.1</b> Topic</a></li>
<li class="chapter" data-level="4.1.2" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#data-2"><i class="fa fa-check"></i><b>4.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#data-wrangling-1"><i class="fa fa-check"></i><b>4.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="4.3" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#data-exploring-1"><i class="fa fa-check"></i><b>4.3</b> Data Exploring</a><ul>
<li class="chapter" data-level="4.3.1" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#pod-size"><i class="fa fa-check"></i><b>4.3.1</b> Pod Size</a></li>
<li class="chapter" data-level="4.3.2" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#sea-surface-temperature"><i class="fa fa-check"></i><b>4.3.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="4.3.3" data-path="part-i-dolphins.html"><a href="part-i-dolphins.html#pod-size-vs-temperature"><i class="fa fa-check"></i><b>4.3.3</b> Pod Size vs Temperature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part-ii-goals.html"><a href="part-ii-goals.html"><i class="fa fa-check"></i><b>5</b> Part II - Goals</a><ul>
<li class="chapter" data-level="5.1" data-path="part-ii-goals.html"><a href="part-ii-goals.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="5.1.1" data-path="part-ii-goals.html"><a href="part-ii-goals.html#topic-3"><i class="fa fa-check"></i><b>5.1.1</b> Topic</a></li>
<li class="chapter" data-level="5.1.2" data-path="part-ii-goals.html"><a href="part-ii-goals.html#data-3"><i class="fa fa-check"></i><b>5.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="part-ii-goals.html"><a href="part-ii-goals.html#analysis-1"><i class="fa fa-check"></i><b>5.2</b> Analysis</a><ul>
<li class="chapter" data-level="5.2.1" data-path="part-ii-goals.html"><a href="part-ii-goals.html#club-goals"><i class="fa fa-check"></i><b>5.2.1</b> Club Goals</a></li>
<li class="chapter" data-level="5.2.2" data-path="part-ii-goals.html"><a href="part-ii-goals.html#competition-goals"><i class="fa fa-check"></i><b>5.2.2</b> Competition Goals</a></li>
<li class="chapter" data-level="5.2.3" data-path="part-ii-goals.html"><a href="part-ii-goals.html#goals-vs-appearances"><i class="fa fa-check"></i><b>5.2.3</b> Goals vs Appearances</a></li>
<li class="chapter" data-level="5.2.4" data-path="part-ii-goals.html"><a href="part-ii-goals.html#goals-per-season"><i class="fa fa-check"></i><b>5.2.4</b> Goals per Season</a></li>
<li class="chapter" data-level="5.2.5" data-path="part-ii-goals.html"><a href="part-ii-goals.html#multiple-goals"><i class="fa fa-check"></i><b>5.2.5</b> Multiple Goals</a></li>
<li class="chapter" data-level="5.2.6" data-path="part-ii-goals.html"><a href="part-ii-goals.html#types-of-goal"><i class="fa fa-check"></i><b>5.2.6</b> Types of Goal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part-ii-grades.html"><a href="part-ii-grades.html"><i class="fa fa-check"></i><b>6</b> Part II - Grades</a><ul>
<li class="chapter" data-level="6.1" data-path="part-ii-grades.html"><a href="part-ii-grades.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="part-ii-grades.html"><a href="part-ii-grades.html#topic-4"><i class="fa fa-check"></i><b>6.1.1</b> Topic</a></li>
<li class="chapter" data-level="6.1.2" data-path="part-ii-grades.html"><a href="part-ii-grades.html#data-4"><i class="fa fa-check"></i><b>6.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="part-ii-grades.html"><a href="part-ii-grades.html#analysis-2"><i class="fa fa-check"></i><b>6.2</b> Analysis</a><ul>
<li class="chapter" data-level="6.2.1" data-path="part-ii-grades.html"><a href="part-ii-grades.html#data-wrangling-2"><i class="fa fa-check"></i><b>6.2.1</b> Data Wrangling</a></li>
<li class="chapter" data-level="6.2.2" data-path="part-ii-grades.html"><a href="part-ii-grades.html#data-exploring-2"><i class="fa fa-check"></i><b>6.2.2</b> Data Exploring</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html"><i class="fa fa-check"></i><b>7</b> Part II - Tennis2017</a><ul>
<li class="chapter" data-level="7.1" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="7.1.1" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#topic-5"><i class="fa fa-check"></i><b>7.1.1</b> Topic</a></li>
<li class="chapter" data-level="7.1.2" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#data-5"><i class="fa fa-check"></i><b>7.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#analysis-3"><i class="fa fa-check"></i><b>7.2</b> Analysis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#wins-and-losses"><i class="fa fa-check"></i><b>7.2.1</b> Wins and Losses</a></li>
<li class="chapter" data-level="7.2.2" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#match-duration"><i class="fa fa-check"></i><b>7.2.2</b> Match Duration</a></li>
<li class="chapter" data-level="7.2.3" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#number-of-aces-vs-height"><i class="fa fa-check"></i><b>7.2.3</b> Number of Aces vs Height</a></li>
<li class="chapter" data-level="7.2.4" data-path="part-ii-tennis2017.html"><a href="part-ii-tennis2017.html#roger-federer"><i class="fa fa-check"></i><b>7.2.4</b> Roger Federer</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA 229 - FINAL PROJECT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-ii---goals" class="section level1">
<h1><span class="header-section-number">5</span> Part II - Goals</h1>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<div id="topic-3" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Topic</h3>
<div class="figure">
<img src="CR7.jpg" alt="Cristiano Ronaldo" />
<p class="caption"><strong>Cristiano Ronaldo</strong></p>
</div>
<p>Cristiano Ronaldo is arguably one of the top football (soccer) player of all time. Ronaldo is famous for his speed, dribbling skills, and most importantly, his goal scoring ability. As a guy who has been following soccer for more than 15 years, I have witnessed so many goals that Ronaldo has scored throughout his career, from stunning direct free kicks to crucial game-winning shots. Ronaldo used to be my favorite player, due to the fact that he spent 6 seasons from 2003 to 2009 with my favorite ball squad - Manchester United. Then he left MU and joined Real Madrid, where he has elevated his game to a whole new level and established himself as one of the top footballers in the world. Because of all the information I just mentioned, I decided to choose a dataset about Ronaldo’s goals and provide some analyses on it.</p>
</div>
<div id="data-3" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Data</h3>
<p>The data was collected from Transfermarkt.com. Notice that all the goals in this dataset are all Ronaldo’s goal at the Club level (i.e. none of them are his International goals for his home nation - Portugal). The dataset does not have any names for the variables, so I will assign the variable’s names. Each of Ronaldo’s goals is represented by the following variables (which I’ll assign, of course!):</p>
<ul>
<li><p>Season: A total of 16 seasons from 2002-03 to 2017-18</p></li>
<li><p>Competition: 11 different leagues and cups that Ronaldo has scored in</p></li>
<li><p>Competition_Type: Whether a competion is a Domestic League, Domestic Cup, European Cup or International Cup</p></li>
<li><p>Club: The 3 clubs that Ronaldo has played for</p></li>
<li><p>Opponent: Clubs that Ronaldo has scored against</p></li>
<li><p>Opponents_Country: The opposing squad’s “nationality”</p></li>
<li><p>Treated_as: For the most part, this is basically where the goals were in the back of the net (Home/Away). But in some cases, for example, UEFA Champions League Final, the game was played at a neutral field, a team will be treated as the “Home” team and got to wear their Home uniform.</p></li>
<li><p>Final_Score: The result of the matches</p></li>
<li><p>Minute: At what point of the match did a goal took place?</p></li>
<li><p>Score_at_this_point: The game score after a goal</p></li>
<li><p>Type_of_goal: Whether a goal is a header, left/right-footed shot, tap-in, penalty or direct free kick</p></li>
</ul>
</div>
</div>
<div id="analysis-1" class="section level2">
<h2><span class="header-section-number">5.2</span> Analysis</h2>
<p>I started off by loading the packages that I’ll need to analyze the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(mosaic)
<span class="kw">library</span>(readxl)
<span class="kw">library</span>(maps)
<span class="kw">library</span>(knitr)</code></pre></div>
<p>Next, the dataset was loaded from my personal drive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;~/Data229/Project/Goals/CR7 Goals.xlsx&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Like I mentioned above, the following names were being assigned to the variables of this dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(Goals) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Season&quot;</span>,<span class="st">&quot;Competition&quot;</span>,<span class="st">&quot;Competition_Type&quot;</span>,<span class="st">&quot;Club&quot;</span>,<span class="st">&quot;Opponent&quot;</span>,<span class="st">&quot;Opponents_Country&quot;</span>,<span class="st">&quot;Treated_as&quot;</span>,<span class="st">&quot;Final_Score&quot;</span>,<span class="st">&quot;Minute&quot;</span>,<span class="st">&quot;Score_at_this_point&quot;</span>,<span class="st">&quot;Type_of_Goal&quot;</span>)</code></pre></div>
<p>There were also a number of missing cells in the inital dataset. This is because when Ronaldo scored multiple goals in one match, they just recorded the goals’ minute, the score after a goal and the type of goal. So the fill() function was used to complete this dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals &lt;-<span class="st"> </span>Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">fill</span>(Season, Competition, Competition_Type, Club, Opponent, Opponents_Country, Treated_as, Final_Score, Minute, Score_at_this_point, Type_of_Goal)</code></pre></div>
<div id="club-goals" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Club Goals</h3>
<p>The first figure that I chose to analyze was Ronaldo’s club goals. Below are the visual and numerical summaries for Ronaldo’s goals for his 3 teams:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Club) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Club_Goals =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Club</th>
<th align="right">Club_Goals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manchester United</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">Real Madrid</td>
<td align="right">449</td>
</tr>
<tr class="odd">
<td align="left">Sporting CP</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Club) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Club_Goals =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> Club_Goals, <span class="dt">fill =</span> Club)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span><span class="st">&quot;Blues&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ronaldo&#39;s Club Goals&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Ronaldo has scored 449 goals for Real Madrid, which is the highest among the 3 clubs that he has played for. He also had 118 goals for Manchester United, and his career Sporting CP goals is only 5.</p>
</div>
<div id="competition-goals" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Competition Goals</h3>
<p>Below are the visual and numerical summaries for Ronaldo’s goals in leagues and cups. I actually created a table called “CompetitionsGoals” since I’ll use this later on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Competition_Goals &lt;-<span class="st"> </span>Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Competition) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Competition_Goals =</span> <span class="kw">n</span>()))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Competition</th>
<th align="right">Competition_Goals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Copa del Rey</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">English Football League Cup</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">English Premier League</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="left">FA Cup</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">FIFA Club World Cup</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">La Liga</td>
<td align="right">310</td>
</tr>
<tr class="odd">
<td align="left">Primeira Liga</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Spanish Supercopa</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Taca de Portugal</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">UEFA Champions League</td>
<td align="right">121</td>
</tr>
<tr class="odd">
<td align="left">UEFA Supercup</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Competition_Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> Competition_Goals, <span class="dt">fill =</span> Competition)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span><span class="st">&quot;Set3&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ronaldo&#39;s Competition Goals&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>Ronaldo has scored the most goals in the La Liga (310). His next 2 highest scoring compeitions are UEFA Champions League (121) and English Premier League (84). On the other hand, Ronaldo’s number of goals in smaller competitions like UEFA Supercup, Taca de Portugal, Primeira Liga,… are very small, primarily due to him playing a tiny amount of games in those leagues/cups (which I’ll get to in just a bit)</p>
</div>
<div id="goals-vs-appearances" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Goals vs Appearances</h3>
<p>Is the a connection between Ronaldo’s goals and the number of competition matches he has participated in? We’ll soon find out!</p>
<p>The table below illustrates the total number of games Ronaldo has played in 11 different leagues/cups (The data was collected from Wikipedia):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Appearances &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>Competition, <span class="op">~</span>Matches,
  <span class="st">&quot;English Premier League&quot;</span>, <span class="dv">196</span>,
  <span class="st">&quot;La Liga&quot;</span>, <span class="dv">291</span>,
  <span class="st">&quot;Primeira Liga&quot;</span>, <span class="dv">25</span>,
  <span class="st">&quot;Taca de Portugal&quot;</span>, <span class="dv">3</span>,
  <span class="st">&quot;Copa del Rey&quot;</span>, <span class="dv">30</span>,
  <span class="st">&quot;FA Cup&quot;</span>, <span class="dv">26</span>,
  <span class="st">&quot;English Football League Cup&quot;</span>, <span class="dv">12</span>,
  <span class="st">&quot;UEFA Supercup&quot;</span>, <span class="dv">2</span>,
  <span class="st">&quot;Spanish Supercopa&quot;</span>, <span class="dv">7</span>,
  <span class="st">&quot;FIFA Club World Cup&quot;</span>, <span class="dv">8</span>,
  <span class="st">&quot;UEFA Champions League&quot;</span>, <span class="dv">158</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Competition</th>
<th align="right">Matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">English Premier League</td>
<td align="right">196</td>
</tr>
<tr class="even">
<td align="left">La Liga</td>
<td align="right">291</td>
</tr>
<tr class="odd">
<td align="left">Primeira Liga</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">Taca de Portugal</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Copa del Rey</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">FA Cup</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">English Football League Cup</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">UEFA Supercup</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Spanish Supercopa</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">FIFA Club World Cup</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">UEFA Champions League</td>
<td align="right">158</td>
</tr>
</tbody>
</table>
<p>Now, let’s make a graph to find out the relationship between goals and games played. But before the plot is made, I joined the 2 tables Competition_Goals and Appearances to get a new table called “Goals_n_Matches”</p>
<p>Here’s a look at that table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Goals_n_Matches &lt;-<span class="st"> </span><span class="kw">full_join</span>(Competition_Goals, Appearances, <span class="dt">by =</span> <span class="st">&quot;Competition&quot;</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Competition</th>
<th align="right">Competition_Goals</th>
<th align="right">Matches</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Copa del Rey</td>
<td align="right">22</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">English Football League Cup</td>
<td align="right">3</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">English Premier League</td>
<td align="right">84</td>
<td align="right">196</td>
</tr>
<tr class="even">
<td align="left">FA Cup</td>
<td align="right">14</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">FIFA Club World Cup</td>
<td align="right">7</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">La Liga</td>
<td align="right">310</td>
<td align="right">291</td>
</tr>
<tr class="odd">
<td align="left">Primeira Liga</td>
<td align="right">3</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">Spanish Supercopa</td>
<td align="right">4</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">Taca de Portugal</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">UEFA Champions League</td>
<td align="right">121</td>
<td align="right">158</td>
</tr>
<tr class="odd">
<td align="left">UEFA Supercup</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Now I can use the table I just created to make my graph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals_n_Matches <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Matches, <span class="dt">y =</span> Competition_Goals)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> Competition)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>The plot reveals a strong, linear and positive relationship between Competition goals and matches. The overall trend is the more games Ronaldo plays in a competition, the more goals he scores.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(Competition_Goals <span class="op">~</span><span class="st"> </span>Matches, <span class="dt">data =</span> Goals_n_Matches)</code></pre></div>
<pre><code>
Call:
lm(formula = Competition_Goals ~ Matches, data = Goals_n_Matches)

Coefficients:
(Intercept)      Matches  
    -9.4125       0.8912  </code></pre>
<p>The regression equation is CompGoals^ = 0.8912*Matches - 9.41</p>
<p>The slope of this equation is 0.8912, which indicates that every extra match is associated with an increase of 0.89 in goals. (If he plays 100 matches, his total goals will increase by about 89)</p>
</div>
<div id="goals-per-season" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Goals per Season</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Season, Club) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Total_Goals =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(Season), <span class="dt">y =</span> Total_Goals)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">size =</span> Total_Goals, <span class="dt">color =</span> Club)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Ronaldo&#39;s Club Goals per Season&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Season&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Goals&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="960" /></p>
<p>Based on the graph, Ronaldo’s scoring has improved throughout his career. During the 6 years stretch from 2010 to 2015, Ronaldo scored 40 or more goals in every single season. His highest scoring season was 2014-15 where he netted more than 60 goals. The number of goals during Ronaldo first 4 years season is not high, simply because he was still a “baby” back then and did not have plenty of playing time.</p>
</div>
<div id="multiple-goals" class="section level3">
<h3><span class="header-section-number">5.2.5</span> Multiple Goals</h3>
<p>Ronaldo is a great scorer, and we’ve seen him scored multiple goals in a match so many times. This table shows how many matches Ronaldo has put the ball in the opponent’s net more than 1 time. I used the following soccer lingo to illustrate the amount of goals scored:</p>
<ul>
<li>Brace = 2 goals</li>
<li>Hat-trick = 3 goals</li>
<li>Poker = 4 goals</li>
<li>Glut = 5 goals</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(MultipleGoals &lt;-<span class="st"> </span>Goals <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Season, Competition, Competition_Type, Club, Opponent, Opponents_Country, Treated_as, Final_Score) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Scored =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Scored <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Scored) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Total =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> Scored, <span class="dt">value =</span> Total) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">Brace =</span> <span class="st">&quot;2&quot;</span>,<span class="st">&quot;Hat-trick&quot;</span> =<span class="st"> &quot;3&quot;</span>, <span class="dt">Poker =</span> <span class="st">&quot;4&quot;</span>, <span class="dt">Glut =</span> <span class="st">&quot;5&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gather</span>(Brace, <span class="st">&#39;Hat-trick&#39;</span>, Poker, Glut, <span class="dt">key =</span> Scored, <span class="dt">value =</span> Total))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Scored</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Brace</td>
<td align="right">104</td>
</tr>
<tr class="even">
<td align="left">Hat-trick</td>
<td align="right">37</td>
</tr>
<tr class="odd">
<td align="left">Poker</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">Glut</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Ronaldo has played against many opponents from different nations in his career. This table is named MultipleGoals and it shows several different countries and how many matches Ronaldo has scored more than 1 goal against opponents from those countries. For example, if Country = France and HowManyTimes = 4, this means CR7 has scored multiple goals in 4 matches against French teams. (This is not the same as the number of goals he has had in France!)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(MultipleGoals &lt;-<span class="st"> </span>Goals <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Season, Competition, Competition_Type, Club, Opponent, Opponents_Country, Treated_as, Final_Score) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Scored =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(Scored <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Opponents_Country) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">Country =</span> Opponents_Country) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">HowManyTimes =</span> <span class="kw">n</span>()))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">HowManyTimes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cyprus</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Denmark</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">England</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Japan</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Netherlands</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Portugal</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Russia</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Spain</td>
<td align="right">92</td>
</tr>
<tr class="even">
<td align="left">Sweden</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Switzerland</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Turkey</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Ukraine</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>The table below shows all the countries in the MultipleGoals table and their latitude (lat) and longtitude (long). I chose that lat and long of the capital city or biggest city of each nation to represent the whole nation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Places &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>Country, <span class="op">~</span>lat, <span class="op">~</span>long,
  <span class="st">&quot;Cyprus&quot;</span>, <span class="fl">35.2</span>, <span class="fl">33.4</span>,
  <span class="st">&quot;Denmark&quot;</span>, <span class="fl">55.7</span>, <span class="fl">12.6</span>,
  <span class="st">&quot;England&quot;</span>, <span class="fl">51.5</span>, <span class="op">-</span><span class="fl">0.1</span>,
  <span class="st">&quot;France&quot;</span>, <span class="fl">48.9</span>, <span class="fl">2.3</span>,
  <span class="st">&quot;Germany&quot;</span>, <span class="fl">52.5</span>, <span class="fl">13.4</span>,
  <span class="st">&quot;Italy&quot;</span>, <span class="fl">41.9</span>, <span class="fl">12.5</span>,
  <span class="st">&quot;Netherlands&quot;</span>, <span class="fl">52.4</span>, <span class="fl">4.9</span>,
  <span class="st">&quot;Portugal&quot;</span>, <span class="fl">38.7</span>, <span class="op">-</span><span class="fl">9.1</span>,
  <span class="st">&quot;Russia&quot;</span>, <span class="fl">55.8</span>, <span class="fl">37.6</span>,
  <span class="st">&quot;Spain&quot;</span>, <span class="fl">40.4</span>, <span class="op">-</span><span class="fl">3.7</span>,
  <span class="st">&quot;Sweden&quot;</span>, <span class="fl">59.3</span>, <span class="fl">18.1</span>,
  <span class="st">&quot;Switzerland&quot;</span>, <span class="fl">47.6</span>, <span class="fl">7.6</span>,
  <span class="st">&quot;Turkey&quot;</span>, <span class="fl">41.0</span>, <span class="fl">29.0</span>,
  <span class="st">&quot;Ukraine&quot;</span>, <span class="fl">50.5</span>, <span class="fl">30.5</span>,
  <span class="st">&quot;Japan&quot;</span>, <span class="fl">35.7</span>, <span class="fl">139.8</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">lat</th>
<th align="right">long</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cyprus</td>
<td align="right">35.2</td>
<td align="right">33.4</td>
</tr>
<tr class="even">
<td align="left">Denmark</td>
<td align="right">55.7</td>
<td align="right">12.6</td>
</tr>
<tr class="odd">
<td align="left">England</td>
<td align="right">51.5</td>
<td align="right">-0.1</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">48.9</td>
<td align="right">2.3</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">52.5</td>
<td align="right">13.4</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">41.9</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">Netherlands</td>
<td align="right">52.4</td>
<td align="right">4.9</td>
</tr>
<tr class="even">
<td align="left">Portugal</td>
<td align="right">38.7</td>
<td align="right">-9.1</td>
</tr>
<tr class="odd">
<td align="left">Russia</td>
<td align="right">55.8</td>
<td align="right">37.6</td>
</tr>
<tr class="even">
<td align="left">Spain</td>
<td align="right">40.4</td>
<td align="right">-3.7</td>
</tr>
<tr class="odd">
<td align="left">Sweden</td>
<td align="right">59.3</td>
<td align="right">18.1</td>
</tr>
<tr class="even">
<td align="left">Switzerland</td>
<td align="right">47.6</td>
<td align="right">7.6</td>
</tr>
<tr class="odd">
<td align="left">Turkey</td>
<td align="right">41.0</td>
<td align="right">29.0</td>
</tr>
<tr class="even">
<td align="left">Ukraine</td>
<td align="right">50.5</td>
<td align="right">30.5</td>
</tr>
<tr class="odd">
<td align="left">Japan</td>
<td align="right">35.7</td>
<td align="right">139.8</td>
</tr>
</tbody>
</table>
<p>Next, I used a full_join to join 2 tables Places and MultipleGoals and I named my new table “Opponents”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Opponents &lt;-<span class="st"> </span><span class="kw">full_join</span>(Places, MultipleGoals, <span class="dt">by =</span> <span class="st">&quot;Country&quot;</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">lat</th>
<th align="right">long</th>
<th align="right">HowManyTimes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cyprus</td>
<td align="right">35.2</td>
<td align="right">33.4</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Denmark</td>
<td align="right">55.7</td>
<td align="right">12.6</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">England</td>
<td align="right">51.5</td>
<td align="right">-0.1</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">France</td>
<td align="right">48.9</td>
<td align="right">2.3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Germany</td>
<td align="right">52.5</td>
<td align="right">13.4</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Italy</td>
<td align="right">41.9</td>
<td align="right">12.5</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">Netherlands</td>
<td align="right">52.4</td>
<td align="right">4.9</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Portugal</td>
<td align="right">38.7</td>
<td align="right">-9.1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Russia</td>
<td align="right">55.8</td>
<td align="right">37.6</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Spain</td>
<td align="right">40.4</td>
<td align="right">-3.7</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">Sweden</td>
<td align="right">59.3</td>
<td align="right">18.1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Switzerland</td>
<td align="right">47.6</td>
<td align="right">7.6</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Turkey</td>
<td align="right">41.0</td>
<td align="right">29.0</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Ukraine</td>
<td align="right">50.5</td>
<td align="right">30.5</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Japan</td>
<td align="right">35.7</td>
<td align="right">139.8</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">World &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>)</code></pre></div>
<p>This map indicates the countries that Ronaldo has scored multiple goals against teams from those countries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">World <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">group =</span> group), <span class="dt">fill =</span> <span class="st">&quot;lightgrey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> Opponents, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> HowManyTimes, <span class="dt">color =</span> Country)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="fl">1.8</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">138</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">33</span>, <span class="dv">75</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) </code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="960" /></p>
<p>The bigger the point is, the more times Ronaldo has scored more than 1 goal in a match against teams from the country represented by that point. Spain (the very big blue point) and England (the big orange point) are the 2 nations where their teams often conceeded more than 1 Ronaldo’s goal in a game. All but 1 country is European - the only 1 that is not is Japan (the lonely dot to the right of the map).</p>
</div>
<div id="types-of-goal" class="section level3">
<h3><span class="header-section-number">5.2.6</span> Types of Goal</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Type_of_Goal) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Type_of_Goal</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Direct free kick</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="left">Header</td>
<td align="right">91</td>
</tr>
<tr class="odd">
<td align="left">Left-footed shot</td>
<td align="right">92</td>
</tr>
<tr class="even">
<td align="left">Penalty</td>
<td align="right">96</td>
</tr>
<tr class="odd">
<td align="left">Right-footed shot</td>
<td align="right">234</td>
</tr>
<tr class="even">
<td align="left">Tap-in</td>
<td align="right">14</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Goals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(Type_of_Goal)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>Overall, we can see that Ronaldo has had more right-footed shots than any other types of goal, which is not surprised because he is right-footed. He is also an all-around scorer. The number of goals as a header, a left-footed shot and a penalty are about the same. Ronaldo has also turned about 50 direct free kicks into goals and the number tap-in’s is the least among the 6 types of goal.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-i-dolphins.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-ii-grades.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
