---
title: "Sport Climbing at Tokyo 2020, Part I: Competition Format"
description: |
  Time for a change
author:
  - name: qntkhvn
    url: https://github.com/qntkhvn
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    highlight: tango
    code_folding: true
    self_contained: false
    toc: true
    toc_depth: 4
draft: true
categories:
  - sport climbing
  - 2020 olympics
  - rankings
---

This is the second post in a series about sport climbing at the 2020 Summer Olympics. In the [first post](https://qntkhvn.netlify.app/posts/2021-07-31-climbing-p1-sim), I performed a simulation study to examine scoring and rankings in sport climbing, under the combined scoring format. 

This time, I'm going to focus on the evidence 

# Background

It was mentioned in my previous post that sport climbing at the 2020 Olympics would took place in a combined format, only awarded one set of medal per gender

After this decision was announced, a number of climbers all over the world immediately reacted and shared their concerns about this new competition format.

Here are some quotes from climbers in [a series of interview with Climbing Magazine in 2016](https://www.climbing.com/news/olympic-climbing-survey-15-pro-climbers-weigh-in/)

Lynn Hill,

> ...I am NOT in support of the format that imposes that all climbers must compete in speed climbing. That is like asking a middle distance runner to compete in the sprint. Speed climbing is a sport within our sport...

Courtney Woods,

> ...Though sport and bouldering are more similar than speed, they still are different disciplines. Speed climbers will have the biggest disadvantage because their realm isn’t based on difficult movements...

Mike Doyle,

> ...Honestly, the people that will suffer the most are the ones that focus only on speed climbing. Those skills/abilities don’t transfer as well to the other disciplines. I don’t see any top speed climbers making it to the Olympics in the first year...

Kai Lightner

>  ...The format is less than ideal. There is some overlap between top athletes in sport climbing and bouldering. However, none of the top speed climbers are also elite in either of the other disciplines...


With words and phrases like "bogus", "a bummer", "less than ideal", "cheesy and unfair" used to describe the new format

# Are the climbers right?

```{r}
library(tidyverse)
theme_set(theme_light())
```


Let's look at 

# Leave one climber out

How wild

```{r}
wf <- read_csv("https://raw.githubusercontent.com/qntkhvn/climbing/main/data/2018_youth_olympics/women_final.csv")
mf <- read_csv("https://raw.githubusercontent.com/qntkhvn/climbing/main/data/2018_youth_olympics/men_final.csv")

drop_rerank <- function(df) {
  rerank <- list()
  for (i in 1:nrow(df)) {
    rerank[[i]] <- df[-i, ] %>%
      mutate(rank_drop = i)
  }
  
  rerank_df <- df %>%
    mutate(rank_drop = 0) %>%
    bind_rows(rerank) %>%
    group_by(rank_drop) %>%
    mutate(
      speed = rank(speed),
      bould = rank(bould),
      lead = rank(lead),
      total = speed * bould * lead
    ) %>%
    arrange(total, .by_group = TRUE) %>%
    ungroup() %>%
    group_by(rank_drop, total) %>%
    mutate(
      speed_tb = ifelse(speed < lag(speed), 1, 0),
      bould_tb = ifelse(bould < lag(bould), 1, 0),
      lead_tb = ifelse(lead < lag(lead), 1, 0),
      tb = speed_tb + bould_tb + lead_tb,
      tb = ifelse(is.na(tb), 1, tb)
    ) %>%
    ungroup() %>%
    group_by(rank_drop) %>%
    arrange(total,-tb, .by_group = TRUE) %>%
    mutate(rank = row_number(),
           last = str_to_title(last))
  
  return(rerank_df)
}
```

```{r, fig.height=4.5, fig.width=8}
drop_rerank(mf) %>% 
  mutate(last = fct_reorder(last, -rank),
         rank = as.factor(rank),
         rank_change = ifelse(
           rank_drop %in% c(0, 4) | 
             rank_drop == 1 & rank %in% 4:5 |
              rank_drop == 2 & rank %in% c(1, 5) |
                rank_drop %in% c(3, 5) & rank %in% c(1, 2, 5) |
                  rank_drop == 6 & rank %in% 1:3, 
           "no", "yes")) %>% 
  ggplot(aes(x = last, y = total, fill = rank_change)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = rank), hjust = -0.2, size = 3) +
  coord_flip() +
  geom_rect(aes(xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf),
            data = ~ filter(., rank_drop %in% c(1, 2, 3, 5, 6)), 
            color = "black", size = 1.5, fill = NA, inherit.aes = FALSE) +
  facet_wrap(~ rank_drop, nrow = 2) +
  expand_limits(y = 102, x = 0:7) +
  scale_fill_manual(values = c("grey", "chocolate")) +
  labs(x = "Men", y = "") +
  theme(axis.ticks = element_blank(),
        panel.grid.minor = element_blank())

drop_rerank(wf) %>% 
  mutate(last = fct_reorder(last, -rank),
         rank = as.factor(rank),
         rank_change = ifelse(
           rank_drop %in% c(0, 1, 4, 6) |
             rank_drop == 2 & rank %in% 1:3 |
              rank_drop == 3 & rank %in% c(1, 4, 5) |
                rank_drop == 5 & rank %in% c(1, 5),
           "no", "yes")) %>%
  ggplot(aes(x = last, y = total, fill = rank_change)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = rank), hjust = -0.2, size = 3) +
  coord_flip() +
  geom_rect(aes(xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf),
            data = ~ filter(., rank_drop %in% c(2, 3, 5)), 
            color = "black", size = 1.5, fill = NA, inherit.aes = FALSE) +
  facet_wrap(~ rank_drop, nrow = 2, ncol = 4) +
  expand_limits(y = 62, x = 0:7) +
  scale_fill_manual(values = c("grey", "red")) +
  labs(y = "\nScore", x = "Women") +
  theme(axis.ticks = element_blank(),
        panel.grid.minor = element_blank())
```

